<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Báo cáo & Thống kê - Thanh Trà Hotel</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/reports.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1"></script>

</head>
<body>

    <div class="page-container">
        <!-- SIDEBAR -->
        <aside id="sidebar-placeholder" class="sidebar"></aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="header">
                <h2 id="content-title">Báo cáo & Thống kê</h2>
                <div class="user-info">
                    <p>Xin chào, <strong id="user-display-name">Admin</strong></p>
                    <img src="https://placehold.co/40x40/E2E8F0/4A5568?text=A" alt="Avatar" class="avatar" id="user-avatar">
                </div>
            </header>

            <!-- Content Area -->
            <div class="content-area">
                <section id="bao-cao-thong-ke" class="content-section active">
                    <div class="card">
                        <!-- Bộ lọc -->
                        <div class="report-filters">
                            <div class="filter-group">
                                <label>Chọn khoảng thời gian</label>
                                <div class="custom-select-wrapper" id="preset-filter-wrapper">
                                    <button type="button" class="custom-select-button" id="preset-filter-btn">
                                        <span id="preset-filter-value">Tháng này</span>
                                        <i class="bi bi-chevron-down"></i>
                                    </button>
                                    <div class="custom-select-options" id="preset-filter-options">
                                        <a href="#" class="custom-select-option" data-value="this-month">Tháng này</a>
                                        <a href="#" class="custom-select-option" data-value="last-month">Tháng trước</a>
                                        <a href="#" class="custom-select-option" data-value="this-quarter">Quý này</a>
                                        <a href="#" class="custom-select-option" data-value="custom">Tùy chỉnh</a>
                                    </div>
                                </div>
                            </div>

                            <div class="filter-group" id="custom-range-group" style="display: none;">
                                <label>Từ ngày</label>
                                <input type="date" id="date-from">
                                <label>Đến ngày</label>
                                <input type="date" id="date-to">
                            </div>

                            <button id="apply-filter-btn" class="btn btn-primary">Áp dụng</button>
                        

                        <!-- KPIs -->
                        
                            <div class="kpi-card">
                                <div class="kpi-icon">$</div>
                                <div class="kpi-content">
                                    <p class="kpi-label">Tổng Doanh thu</p>
                                    <p class="kpi-value" id="kpi-revenue">0 ₫</p>
                                </div>
                                <div class="chart-actions" style="margin-top:8px; text-align:right;">
                                    <button id="reset-zoom-btn" class="btn btn-sm btn-outline-secondary" style="display:none;">
                                        Reset Zoom
                                    </button>
                                </div>
                            </div>


                        
                        </div>

                        <!-- Tabs -->
                        <div class="tab-container">
                            <button class="tab-btn active" data-tab="revenue">Doanh thu</button>
                            <button class="tab-btn" data-tab="services">Dịch vụ</button>
                            <button class="tab-btn" data-tab="room-types">Loại phòng</button>
                            <button class="tab-btn" data-tab="damages">Thiệt hại thiết bị</button>
                            <button class="tab-btn" data-tab="reviews">Đánh giá</button>
                        </div>

                        <!-- Tab: Doanh thu -->
                        <div class="tab-content" id="revenue">
                            <div class="chart-container">
                                <h4>Xu hướng Doanh thu</h4>
                                <canvas id="revenueTrendChart"></canvas>
                            </div>
                        </div>

                        <!-- Tab: Dịch vụ -->
                        <div class="tab-content" id="services" style="display: none;">
                            <div class="chart-container">
                                <h4>Top Dịch vụ Bán chạy</h4>
                                <canvas id="topServicesChart"></canvas>
                            </div>

                            <!-- THÊM DÒNG TỔNG DOANH THU DỊCH VỤ -->
                            <div class="summary-card" style="margin-top: 20px; padding: 15px; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                                <p style="margin:0; font-size:1.1rem;">
                                    <strong>Tổng doanh thu dịch vụ:</strong> 
                                    <span id="total-service-revenue" style="color:#ff9800; font-size:1.4rem; font-weight:bold;">0 ₫</span>
                                </p>
                            </div>
                        </div>

                        <div class="tab-content" id="room-types" style="display: none;">
                            <div class="chart-container">
                                <h4>Top Loại phòng Doanh thu Cao nhất</h4>
                                <canvas id="topRoomTypesChart"></canvas>
                            </div>
                        </div>

                        <!-- Tab: Thiệt hại thiết bị -->
                        <div class="tab-content" id="damages" style="display: none;">
                            <div class="chart-container">
                                <h4>Top Thiết bị bị hư hỏng</h4>
                                <canvas id="damageEquipmentChart"></canvas>
                            </div>

                            <div class="summary-card" style="margin-top: 20px; padding: 15px; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                                <p style="margin:0; font-size:1.1rem;">
                                    <strong>Tổng tiền bồi thường:</strong> 
                                    <span id="total-damage-amount" style="color:#ff9800; font-size:1.3rem; font-weight:bold;">0 ₫</span>
                                </p>
                            </div>
                        </div>                        

                        <div class="tab-content" id="reviews" style="display: none;">
                            <div class="chart-container">
                                <h4>Đánh giá từ khách hàng</h4>
                                <div id="reviews-container" class="reviews-list"></div>
                            </div>
                        </div>
                        

                    </div>
                </section>
            </div>
        </main>
    </div>
    
    <script src="js/main.js" type="module" defer></script>
    <script src="./api/reports.api.js" type="module"></script>
    <script src="./js/reports.js" type="module" defer></script>
</body>
</html>