<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω D·ªãch V·ª• - L·ªÖ T√¢n</title>
    <link rel="stylesheet" href="css/letan_dashboard.css">
    <link rel="stylesheet" href="css/services.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo">
            <i class="fas fa-hotel"></i>
            <h2>L·ªÖ T√¢n</h2>
        </div>
        <nav class="nav-menu">
            <a href="letan_dashboard.html" class="nav-item">
                <i class="fas fa-chart-line"></i>
                <span>T·ªïng Quan</span>
            </a>
            <a href="checkin.html" class="nav-item">
                <i class="fas fa-calendar-check"></i>
                <span>Check-in</span>
            </a>
            <a href="checkout.html" class="nav-item">
                <i class="fas fa-door-open"></i>
                <span>Check-out</span>
            </a>
            <a href="services.html" class="nav-item active">
                <i class="fas fa-concierge-bell"></i>
                <span>D·ªãch V·ª•</span>
            </a>
            <a href="rooms_management.html" class="nav-item">
                <i class="fas fa-bed"></i>
                <span>Qu·∫£n L√Ω Ph√≤ng</span>
            </a>
            <a href="booking.html" class="nav-item">
                <i class="fas fa-calendar-alt"></i>
                <span>ƒê·∫∑t Ph√≤ng</span>
            </a>
            <a href="room_change.html" class="nav-item">
                <i class="fas fa-exchange-alt"></i>
                <span>ƒê·ªïi Ph√≤ng</span>
            </a>
            <a href="customers.html" class="nav-item">
                <i class="fas fa-users"></i>
                <span>Kh√°ch H√†ng</span>
            </a>
            <a href="booking_list.html" class="nav-item">
                <i class="fas fa-users"></i>
                <span>Danh S√°ch ƒê·∫∑t Ph√≤ng</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <a href="#" class="nav-item">
                <i class="fas fa-sign-out-alt"></i>
                <span>ƒêƒÉng Xu·∫•t</span>
            </a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <button class="menu-toggle" id="menuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1>Qu·∫£n L√Ω D·ªãch V·ª•</h1>
            </div>
            <div class="header-right">
                <div class="user-profile">
                    <i class="fas fa-user-circle"></i>
                    <span id="userName">L·ªÖ T√¢n</span>
                </div>
            </div>
        </header>

        <!-- N·ªôi Dung Ch√≠nh -->
        <div class="services-content">
            <!-- T√¨m Ki·∫øm Kh√°ch H√†ng -->
            <section class="search-section">
                <div class="search-card">
                    <h2><i class="fas fa-search"></i> T√¨m Ki·∫øm Kh√°ch H√†ng</h2>
                    <form class="search-form" onsubmit="event.preventDefault(); searchGuest();">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="searchBookingCode">M√£ Booking</label>
                                <input type="text" id="searchBookingCode" placeholder="Nh·∫≠p m√£ booking">
                            </div>
                            <div class="form-group">
                                <label for="searchRoomNumber">S·ªë Ph√≤ng</label>
                                <input type="text" id="searchRoomNumber" placeholder="Nh·∫≠p s·ªë ph√≤ng">
                            </div>
                            <div class="form-group">
                                <label for="searchCustomerName">T√™n Kh√°ch H√†ng</label>
                                <input type="text" id="searchCustomerName" placeholder="Nh·∫≠p t√™n kh√°ch h√†ng">
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-search"></i> T√¨m Ki·∫øm
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="resetSearch()">
                                <i class="fas fa-refresh"></i> L√†m M·ªõi
                            </button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Danh S√°ch Kh√°ch ƒêang ·ªû -->
            <section class="data-section">
                <div class="data-card">
                    <div class="card-header">
                        <h2><i class="fas fa-users"></i> Kh√°ch ƒêang ·ªû</h2>
                        <div class="card-actions">
                            <span id="guestCount" class="badge badge-info">0 kh√°ch</span>
                        </div>
                    </div>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>M√£ Booking</th>
                                    <th>Kh√°ch H√†ng</th>
                                    <th>S·ªë ƒêi·ªán Tho·∫°i</th>
                                    <th>Ph√≤ng</th>
                                    <th>Check-in</th>
                                    <th>Check-out</th>
                                    <th>Tr·∫°ng Th√°i</th>
                                    <th>Thao T√°c</th>
                                </tr>
                            </thead>
                            <tbody id="currentGuestsList">
                                <tr>
                                    <td colspan="8" class="no-data">
                                        <i class="fas fa-spinner fa-spin"></i> ƒêang t·∫£i d·ªØ li·ªáu...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Modal D·ªãch V·ª• -->
    <div id="servicesModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-concierge-bell"></i> D·ªãch V·ª• Kh√°ch H√†ng</h2>
                <button class="modal-close" onclick="closeServicesModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Th√¥ng Tin Kh√°ch H√†ng -->
                <div class="customer-info">
                    <h3><i class="fas fa-user"></i> Th√¥ng Tin Kh√°ch H√†ng</h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <label>M√£ Booking:</label>
                            <span id="modalBookingCode">-</span>
                        </div>
                        <div class="info-item">
                            <label>Kh√°ch H√†ng:</label>
                            <span id="modalCustomerName">-</span>
                        </div>
                        <div class="info-item">
                            <label>S·ªë Ph√≤ng:</label>
                            <span id="modalRoomNumber">-</span>
                        </div>
                        <div class="info-item">
                            <label>S·ªë ƒêi·ªán Tho·∫°i:</label>
                            <span id="modalPhone">-</span>
                        </div>
                    </div>
                </div>

                <!-- Danh S√°ch D·ªãch V·ª• -->
                <div class="available-services">
                    <h3><i class="fas fa-list"></i> Danh S√°ch D·ªãch V·ª•</h3>
                    <div class="services-grid" id="servicesGrid">
                        <!-- D·ªãch v·ª• s·∫Ω ƒë∆∞·ª£c t·∫£i ·ªü ƒë√¢y -->
                    </div>
                </div>

                <!-- D·ªãch V·ª• ƒê√£ Ch·ªçn -->
                <div class="selected-services">
                    <h3><i class="fas fa-shopping-cart"></i> D·ªãch V·ª• ƒê√£ Ch·ªçn</h3>
                    <div class="selected-list" id="selectedServicesList">
                        <p class="no-data">Ch∆∞a c√≥ d·ªãch v·ª• n√†o ƒë∆∞·ª£c ch·ªçn</p>
                    </div>
                    <div class="total-amount">
                        <strong>T·ªïng c·ªông: <span id="totalServiceAmount">0 VNƒê</span></strong>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeServicesModal()">
                    <i class="fas fa-times"></i> H·ªßy
                </button>
                <button class="btn btn-primary" onclick="confirmServices()">
                    <i class="fas fa-check"></i> X√°c Nh·∫≠n D·ªãch V·ª•
                </button>
            </div>
        </div>
    </div>

    <!-- Modal L·ªãch S·ª≠ D·ªãch V·ª• -->
    <div id="serviceHistoryModal" class="modal">
        <div class="modal-content history-modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-history"></i> L·ªãch S·ª≠ D·ªãch V·ª•</h2>
                <button class="modal-close" onclick="closeServiceHistoryModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <!-- Th√¥ng tin kh√°ch h√†ng -->
                <div class="customer-info">
                    <h3><i class="fas fa-user"></i> Th√¥ng Tin Booking</h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <label>M√£ Booking:</label>
                            <span id="historyBookingCode">-</span>
                        </div>
                        <div class="info-item">
                            <label>Kh√°ch H√†ng:</label>
                            <span id="historyCustomerName">-</span>
                        </div>
                        <div class="info-item">
                            <label>S·ªë Ph√≤ng:</label>
                            <span id="historyRoomNumber">-</span>
                        </div>
                    </div>
                </div>

                <!-- B·∫¢NG L·ªäCH S·ª¨ D·ªäCH V·ª§ -->
                <!-- B·∫¢NG L·ªäCH S·ª¨ D·ªäCH V·ª§ -->
                <div class="history-content">
                    <h3><i class="fas fa-list-ul"></i> Chi Ti·∫øt D·ªãch V·ª• ƒê√£ S·ª≠ D·ª•ng</h3>

                    <!-- üü¢ D·ªãch v·ª• ƒê√É THANH TO√ÅN -->
                    <div class="history-table-container">
                        <h4 style="color:green; margin-bottom:8px;">
                            <i class="fas fa-check-circle"></i> D·ªãch v·ª• ƒë√£ thanh to√°n
                        </h4>
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>STT</th>
                                    <th>T√™n D·ªãch V·ª•</th>
                                    <th>S·ªë L∆∞·ª£ng</th>
                                    <th>ƒê∆°n Gi√°</th>
                                    <th>Th√†nh Ti·ªÅn</th>
                                    <th>Tr·∫°ng Th√°i</th>
                                </tr>
                            </thead>
                            <tbody id="paidServiceTable">
                                <tr>
                                    <td colspan="6" class="text-center">ƒêang t·∫£i...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- üî¥ D·ªãch v·ª• CH∆ØA THANH TO√ÅN -->
                    <div class="history-table-container" style="margin-top: 20px;">
                        <h4 style="color:#d9534f; margin-bottom:8px;">
                            <i class="fas fa-exclamation-circle"></i> D·ªãch v·ª• ch∆∞a thanh to√°n
                        </h4>
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>STT</th>
                                    <th>T√™n D·ªãch V·ª•</th>
                                    <th>S·ªë L∆∞·ª£ng</th>
                                    <th>ƒê∆°n Gi√°</th>
                                    <th>Th√†nh Ti·ªÅn</th>
                                    <th>Tr·∫°ng Th√°i</th>
                                </tr>
                            </thead>
                            <tbody id="unpaidServiceTable">
                                <tr>
                                    <td colspan="6" class="text-center">ƒêang t·∫£i...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- T·ªïng k·∫øt -->
                    <div class="history-summary" style="margin-top: 20px; border-top: 1px solid #ccc; padding-top: 10px;">
                        <div class="summary-item">
                            <span class="summary-label">T·ªïng ƒë√£ thanh to√°n:</span>
                            <span class="summary-value" id="totalPaid">0 VNƒê</span>
                        </div>
                        <div class="summary-item total">
                            <span class="summary-label">T·ªïng ch∆∞a thanh to√°n:</span>
                            <span class="summary-value" id="totalUnpaid">0 VNƒê</span>
                        </div>
                    </div>
                </div>


                <!-- No Data State -->
                <div class="no-history-data" id="noHistoryData" style="display: none;">
                    <div class="empty-state">
                        <i class="fas fa-clipboard-list"></i>
                        <h3>Ch∆∞a c√≥ d·ªãch v·ª• n√†o</h3>
                        <p>Booking n√†y ch∆∞a s·ª≠ d·ª•ng d·ªãch v·ª• n√†o.</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeServiceHistoryModal()">
                    <i class="fas fa-times"></i> ƒê√≥ng
                </button>
                <!-- Print button removed as requested -->
            </div>
        </div>
    </div>

    <script src="api/service.api.js"></script>
    <script src="js/service.ui.js"></script>
    <script src="api/navigation-preloader.js"></script>

    <!-- T·∫¢I D·ªÆ LI·ªÜU  -->
    <div id="loadingOverlay" class="modal" style="display:none; align-items:center; justify-content:center;">
        <div style="background:#fff; padding:20px 30px; border-radius:8px; box-shadow:0 6px 18px rgba(0,0,0,0.2); display:flex; gap:12px; align-items:center;">
            <i class="fas fa-spinner fa-spin" style="font-size:20px;"></i>
            <div id="loadingMessage">ƒêang t·∫£i...</div>
        </div>
    </div>
</body>

</html>